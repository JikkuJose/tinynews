#!/usr/bin/env ruby

require 'thor'
require 'yaml'
require 'tinynews'


module TinyNews

  f = File.open( "sources.yml", "r" ).read
  SOURCES = YAML::load( f )

  class TinyNewsCLI < Thor

    desc "list", "Lists the available news feeds."
    def list
      puts "List of news feed sources: "
      SOURCES.each do |symbol, source|
        puts "- #{source[:title]}"
      end
    end

    desc "--NEWS_SOURCE", "Show news for NEWS_SOURCE"
    SOURCES.keys.each do |source_symbol|
      option source_symbol, :type => :boolean
    end
    def news_from_option
      TinyNews.print_to_cli( options.keys.last.to_sym )
    end

    default_task :news_from_option

  end
end

TinyNews::TinyNewsCLI.start( ARGV )
